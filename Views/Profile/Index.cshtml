@model StudentDashboard.Models.User
@{
    ViewData["Title"] = "Profile";
}

<div class="profile-container">
    <div class="profile-header">
        <div class="profile-avatar-section">
            <div class="profile-avatar-large">
                <img src="@(Model.Avatar ?? "/images/avatar.png")" alt="Profile" id="profileImage" />
                <button class="avatar-edit-btn" onclick="document.getElementById('avatarInput').click()">
                    <i class="fas fa-camera"></i>
                </button>
                <input type="file" id="avatarInput" accept="image/*" style="display: none;" />
            </div>
            <h1>@Model.FirstName @Model.LastName</h1>
            <p class="profile-role">@Model.Role</p>
        </div>
        <div class="profile-stats">
            <div class="stat-item">
                <span class="stat-number">@Model.CreatedAt.ToString("MMM yyyy")</span>
                <span class="stat-label">Member Since</span>
            </div>
            <div class="stat-item">
                <span class="stat-number">@(Model.LastLoginAt?.ToString("MMM dd") ?? "Never")</span>
                <span class="stat-label">Last Login</span>
            </div>
        </div>
    </div>

    <div class="profile-content">
        <div class="profile-tabs">
            <button class="tab-btn active" data-tab="personal">Personal Info</button>
            <button class="tab-btn" data-tab="academic">Academic</button>
            <button class="tab-btn" data-tab="settings">Settings</button>
        </div>

        <div class="tab-content">
            <!-- Personal Information Tab -->
            <div class="tab-panel active" id="personal">
                <div class="form-section">
                    <h3>Personal Information</h3>
                    <form id="personalForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="firstName">First Name</label>
                                <input type="text" id="firstName" name="firstName" value="@Model.FirstName" />
                            </div>
                            <div class="form-group">
                                <label for="lastName">Last Name</label>
                                <input type="text" id="lastName" name="lastName" value="@Model.LastName" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" name="email" value="@Model.Email" readonly />
                        </div>
                        <div class="form-group">
                            <label for="phoneNumber">Phone Number</label>
                            <input type="tel" id="phoneNumber" name="phoneNumber" value="@(Model.PhoneNumber ?? "")" />
                        </div>
                        <div class="form-group">
                            <label for="address">Address</label>
                            <textarea id="address" name="address" rows="3">@(Model.Address ?? "")</textarea>
                        </div>
                        <button type="submit" class="btn-primary">Save Changes</button>
                    </form>
                </div>
            </div>

            <!-- Academic Information Tab -->
            <div class="tab-panel" id="academic">
                <div class="academic-section">
                    <h3>Academic Progress</h3>
                    <div class="academic-stats">
                        <div class="academic-stat">
                            <div class="stat-icon">
                                <i class="fas fa-graduation-cap"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">3.8</span>
                                <span class="stat-label">Current GPA</span>
                            </div>
                        </div>
                        <div class="academic-stat">
                            <div class="stat-icon">
                                <i class="fas fa-book"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">24</span>
                                <span class="stat-label">Credits Completed</span>
                            </div>
                        </div>
                        <div class="academic-stat">
                            <div class="stat-icon">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value">15</span>
                                <span class="stat-label">Awards Earned</span>
                            </div>
                        </div>
                    </div>

                    <div class="courses-section">
                        <h4>Current Courses</h4>
                        <div class="course-list">
                            <div class="course-item">
                                <div class="course-info">
                                    <h5>UX/UI Design</h5>
                                    <p>Advanced Interface Design</p>
                                </div>
                                <div class="course-progress">
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 75%"></div>
                                    </div>
                                    <span class="progress-text">75%</span>
                                </div>
                            </div>
                            <div class="course-item">
                                <div class="course-info">
                                    <h5>Web Development</h5>
                                    <p>Full Stack Development</p>
                                </div>
                                <div class="course-progress">
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 60%"></div>
                                    </div>
                                    <span class="progress-text">60%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-panel" id="settings">
                <div class="settings-section">
                    <h3>Account Settings</h3>
                    
                    <div class="setting-group">
                        <h4>Change Password</h4>
                        <form id="passwordForm">
                            <div class="form-group">
                                <label for="currentPassword">Current Password</label>
                                <input type="password" id="currentPassword" name="currentPassword" />
                            </div>
                            <div class="form-group">
                                <label for="newPassword">New Password</label>
                                <input type="password" id="newPassword" name="newPassword" />
                            </div>
                            <div class="form-group">
                                <label for="confirmPassword">Confirm New Password</label>
                                <input type="password" id="confirmPassword" name="confirmPassword" />
                            </div>
                            <button type="submit" class="btn-primary">Change Password</button>
                        </form>
                    </div>

                    <div class="setting-group">
                        <h4>Notifications</h4>
                        <div class="notification-settings">
                            <label class="checkbox-label">
                                <input type="checkbox" checked />
                                <span class="checkmark"></span>
                                Email notifications
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" checked />
                                <span class="checkmark"></span>
                                Assignment reminders
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" />
                                <span class="checkmark"></span>
                                Grade updates
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" checked />
                                <span class="checkmark"></span>
                                Course announcements
                            </label>
                        </div>
                    </div>

                    <div class="setting-group">
                        <h4>Privacy</h4>
                        <div class="privacy-settings">
                            <label class="checkbox-label">
                                <input type="checkbox" checked />
                                <span class="checkmark"></span>
                                Show profile to other students
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" />
                                <span class="checkmark"></span>
                                Show grades in leaderboard
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Tab switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const tabId = this.dataset.tab;
                
                // Remove active class from all tabs and panels
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding panel
                this.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Avatar upload
        document.getElementById('avatarInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('profileImage').src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        });

        // Form submissions
        document.getElementById('personalForm').addEventListener('submit', function(e) {
            e.preventDefault();
            // Handle personal info update
            showNotification('Personal information updated successfully!', 'success');
        });

        document.getElementById('passwordForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (newPassword !== confirmPassword) {
                showNotification('Passwords do not match!', 'error');
                return;
            }
            
            // Handle password change
            showNotification('Password changed successfully!', 'success');
        });
    </script>
}
